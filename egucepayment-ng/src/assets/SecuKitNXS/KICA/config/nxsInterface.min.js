/*
=============================================================================
 * Project   : SecuKitNXS(Non ActiveXìš© Script) v1.0.3.0
 * Producer  : KICA, http://www.signgate.com
 * Publisher : KICA Inc.,webmaster@signgate.com
 * Update    : 2016-10-18
=============================================================================
 */
function nxsModuleChk(){var a={license:secukitnxInfo.license};SECUKITNX.Invoke("checkLicense",[a],"secukitnxInterface.SecuKitNX_EXCallBack","nxsModuleChkCallback")}function nxsModuleChkCallback(a){if(NXSBlockWrapLayer===!0)try{$(".nxs_loading_block").hide()}catch(b){nxlog("_nxsModuleChkCallback : ",b)}var c=-1;try{c=a.ERROR_CODE}catch(d){nxlog("_nxsModuleChkCallback : ",d)}if(void 0===c)if("Y"===a.checkLicense)NXsetEnvironment(),SECUKITNX_CONST.load=!0,SECUKITNX_CONST.licenseChk=!0,SecuKitNX_Ready(!0),nxlog("_nxsModuleChkCallback - nxLicense : ",a.checkLicense);else{SECUKITNX_CONST.load=!0,SECUKITNX_CONST.licenseChk=!1,SecuKitNX_Ready(!1),nxlog("_nxsModuleChkCallback - nxLicense : ",a.checkLicense),KICA_Error.init();var e="NXS_LICENSE ERROR",f="LICENSE ERR";KICA_ERROR_RESOURCE.ErrorMessage(e,f,"ERR_CLIENT_LICENSE");var g=KICA_Error.getScriptError();alert(g)}else{SECUKITNX_CONST.load=!0,SECUKITNX_CONST.licenseChk=!1,nxlog("_nxsModuleChkCallback - nxLicense: ",a.ERROR_MESSAGE),SecuKitNX_Ready(!1),KICA_Error.init(),$(".nx-cert-select").hide(),$("#nx-pki-ui-wrapper").hide(),KICA_Error.init(),KICA_Error.setError(a.ERROR_CODE,a.ERROR_MESSAGE);var h=KICA_Error.getError();alert(h)}}function NXGetPFXFilePath(){var a="NXGetPFXFilePath.getFilePath",b={fileType:"pfx"},c=JSON.stringify(b);secukitnxInterface.SecuKitNX_EX(a,c)}function NXGetPFXFilePathCallback(a){var b=-1;try{b=a.ERROR_CODE}catch(c){console.log(c)}if(void 0===b){var d=a.getFilePath;document.getElementById("importPFXFileName").value=d}else{KICA_Error.init(),KICA_Error.setError(a.ERROR_CODE,a.ERROR_MESSAGE);var e=KICA_Error.getError();alert(e)}}var SECUKITNX,secukitnxInfo={exPluginCallName:"SECUKITNX",exPluginName:"SECUKITNX",exPluginInfo:"secukitnxInfo",exModuleName:"secukitnx",moduleInfo:{exNxClient_kpmcnt_exe:Module_KPMCNT_Ver,exNxClient_kpmsvc_exe:Module_KPMSVC_Ver,exNxClient_secukitNX_dll:Module_NX_Ver,exNxClient_secuXML_dll:Module_XML_Ver,exNxClient_kms_dll:Module_KMS_Ver},exServiceInfo:{isUse:!0,localhost:"https://127.0.0.1",localhost2:"http://127.0.0.1",PortNum:14315,PortNum2:14319},checkSpec:!0,reqSpec:{OS:{WINDOWS:"5.1"},Browser:{MSIE:"6",EDGE:"ALL",CHROME:"38",FIREFOX:"36"}},license:NXS_LICENSE},secukitnxInterface={CustomEX:function(a,b){var c="secukitnxInterface.CustomEXCallback";if(!a)return void nxalert("secukitnxInterface.CustomEX",NX_EX_INTERFACE_TEXT_6);try{var d=JSON.parse(b);b=d}catch(e){}SECUKITNX.Invoke(a,[b],c)},CustomEXCallback:function(a){try{var b=JSON.stringify(a);nxlog("secukitnxInterface.CustomEXCallback",a);var c=document.getElementById("resultArea");c?c.value=b:alert(b)}catch(d){nxlog("secukitnxInterface.CustomEXCallback [exception] result",a),nxalert("secukitnxInterface.CustomEXCallback",NX_EX_INTERFACE_TEXT_4+"\nresult : "+a+"\nexception : "+d)}},SecuKitNX:function(a,b){var c=a.indexOf("."),d=a.substring(c+1,a.length),e=a+"Callback",f="secukitnxInterface.SecuKitNXCallBack";if(!a)return void nxalert("secukitnxInterface.SecuKitNX",NX_EX_INTERFACE_TEXT_6);nxlog("secukitnxInterface.SecuKitNX Command Message : ",b);try{var g=JSON.parse(b);b=g}catch(h){}SECUKITNX.Invoke(d,[b],f,e)},SecuKitNXCallBack:function(result){try{var strSerial=JSON.stringify(result);void 0!==result.reply.ERROR_CODE&&(KICA_Error.init(),KICA_Error.setError(result.reply.ERROR_CODE,result.reply.ERROR_MESSAGE)),nxlog("secukitnxInterface.SecuKitNXCallBack",result);try{eval(result.callback)(result.reply)}catch(e){}}catch(e){nxlog("secukitnxInterface.SecuKitNXCallBack [exception] result",result),nxlog("secukitnxInterface.SecuKitNXCallBack",NX_EX_INTERFACE_TEXT_4+"\nresult : "+result+"\nexception : "+e)}},SecuKitNX_EX:function(a,b){var c=a.indexOf("."),d=a.substring(c+1,a.length),e=a.substring(0,c),f=e+"Callback",g="secukitnxInterface.SecuKitNX_EXCallBack";if(nxlog("secukitnxInterface.SecuKitNX_EX Command Message : ",b),!a)return void nxalert("secukitnxInterface.SecuKitNX_EX",NX_EX_INTERFACE_TEXT_6);try{var h=JSON.parse(b);b=h}catch(i){}SECUKITNX.Invoke(d,[b],g,f)},SecuKitNX_EXCallBack:function(result){try{var strSerial=JSON.stringify(result);void 0!==result.reply.ERROR_CODE&&(KICA_Error.init(),KICA_Error.setError(result.reply.ERROR_CODE,result.reply.ERROR_MESSAGE)),nxlog("secukitnxInterface.SecuKitNX_EXCallBack",result);try{eval(result.callback)(result.reply)}catch(e){}}catch(e){nxlog("secukitnxInterface.SecuKitNXCallBack [exception] result",result),nxlog("secukitnxInterface.SecuKitNXCallBack",NX_EX_INTERFACE_TEXT_4+"\nresult : "+result+"\nexception : "+e)}},SecuKitNXS:function(a,b){var c=a.indexOf("."),d=a.substring(c+1,a.length),e=a.substring(0,c),f=e+"Callback",g="secukitnxInterface.SecuKitNXSCallBack";if(!a)return void nxalert("secukitnxInterface.SecuKitNXS",NX_EX_INTERFACE_TEXT_6);nxlog("secukitnxInterface.SecuKitNXS Command Message : ",b);try{var h=JSON.parse(b);b=h}catch(i){}SECUKITNX.Invoke(d,[b],g,f)},SecuKitNXSCallBack:function(result){try{var strSerial=JSON.stringify(result);void 0!==result.reply.ERROR_CODE&&(KICA_Error.init(),KICA_Error.setError(result.reply.ERROR_CODE,result.reply.ERROR_MESSAGE)),nxlog("secukitnxInterface.SecuKitNXSCallBack",result);try{var funNameCallback=result.callback,funName=funNameCallback.replace("Callback","");eval("SecuKitNXS_RESULT")(funName,result.reply)}catch(e){}}catch(e){nxlog("secukitnxInterface.SecuKitNXSCallBack [exception] result",result),nxlog("secukitnxInterface.SecuKitNXSCallBack",NX_EX_INTERFACE_TEXT_4+"\nresult : "+result+"\nexception : "+e)}}},SECUKITNX_CONST={debug:ConsoleLogFlag,debugAlert:!0,exEXObjName:"SECUKITNX",frameName:"",browserInfo:"",OSInfo:"",pluginInfo:[],extabid:"",pluginCount:0,isInstalled:!1,nextVerCheck:!1,licenseChk:!1,load:!1,json2Path:secukitnxBaseDir+"KICA/config/3rd/json2.js",cmdCnt:[],intervalCheckCnt:0,serviceType:1,serviceToken:"empty"};if("object"!=typeof JSON||navigator.userAgent.match(/msie 8/i))try{JSON={},document.write("<script type='text/javascript' src='"+SECUKITNX_CONST.json2Path+"'></script>")}catch(e){alert("json2.js load error")}var SECUKITNX_LOADING=function(callback){if(SECUKITNX_CONST.pluginInfo.length<=0)return void alert(NX_EXPROTO_TEXT_1);if(SECUKITNX_CHECK.chkInfoStatus.status){for(var chk=!0,i=0;i<SECUKITNX_CONST.pluginInfo.length;i++){var pluginInfo=SECUKITNX_CONST.pluginInfo[i];try{eval(pluginInfo.exPluginName+" = new "+SECUKITNX_CONST.exEXObjName+"_EX(pluginInfo);")}catch(e){nxlog("_LOADING [exception]",e),nxalert("_LOADING [exception]",e),chk=!1;break}}SECUKITNX_CONST.isInstalled=!0,callback&&setTimeout(function(){eval(callback)(chk)},5)}else alert(NX_EXPROTO_TEXT_2),callback&&eval(callback)(!1)},_IntervalChk="",_requestMsg="",SECUKITNX_CHECK={chkCallback:"",chkInfoStatus:{status:!1,info:[]},chkCurrPluginCnt:0,check:function(a,b){if(_requestMsg="",SECUKITNX_CONST.frameName=SECUKITNX_UTIL.findPath(self),SECUKITNX_CONST.OSInfo=SECUKITNX_UTIL.getOSInfo(),SECUKITNX_CONST.browserInfo=SECUKITNX_UTIL.getBrowserInfo(),nxlog("_CONST.frameName",SECUKITNX_CONST.frameName),nxlog("_CONST.OSInfo",SECUKITNX_CONST.OSInfo),nxlog("_CONST.browserInfo",SECUKITNX_CONST.browserInfo),SECUKITNX_CONST.extabid||(SECUKITNX_CONST.extabid=SECUKITNX_UTIL.createId()),nxlog("_CHECK.check",a),this.chkInfoStatus={status:!1,info:[]},this.chkCurrPluginCnt=0,a&&a.length>0){var c=a.length;SECUKITNX_CONST.pluginInfo=[];for(var d=0;c>d;d++){SECUKITNX_CONST.pluginInfo.push(a[d]);var e={name:a[d].exPluginName};this.chkInfoStatus.info.push(e)}}else if(SECUKITNX_CONST.pluginInfo.length<=0)return void alert(NX_EXPROTO_TEXT_3);return b?(this.chkCallback=b,SECUKITNX_CONST.pluginCount=SECUKITNX_CONST.pluginInfo.length,this.moduleCheck(0),void(0===SECUKITNX_CONST.intervalCheckCnt&&(SECUKITNX_CONST.intervalCheckCnt=1,this.intervalCheck()))):void alert(NX_EXPROTO_TEXT_4)},intervalCheck:function(){_IntervalChk=setInterval(function(){SECUKITNX_CONST.load||""!==_requestMsg?(nxlog("### SECUKITNX_CHECK.intervalCheck - SECUKITNX_CONST.load: ",SECUKITNX_CONST.load),clearInterval(_IntervalChk)):(nxlog("### SECUKITNX_CHECK.intervalCheck - SECUKITNX_CONST.load: ",SECUKITNX_CONST.load),SECUKITNX_CHECK.moduleCheck(0))},2e3)},moduleCheck:function(currPluginCnt){if(SECUKITNX_CONST.extabid||(SECUKITNX_CONST.extabid=SECUKITNX_UTIL.createId()),SECUKITNX_CHECK.chkCurrPluginCnt=currPluginCnt,currPluginCnt>=SECUKITNX_CONST.pluginCount){for(var chk=!0,i=0;i<SECUKITNX_CONST.pluginCount;i++){var currInstalled=!0,currStatus=SECUKITNX_CHECK.chkInfoStatus.info[i];1===SECUKITNX_CONST.serviceType&&(currStatus.nx||(chk=!1,currInstalled=!1)),2===SECUKITNX_CONST.serviceType&&(currStatus.xml||(chk=!1,currInstalled=!1)),3===SECUKITNX_CONST.serviceType&&(currStatus.kms||(chk=!1,currInstalled=!1)),currStatus.kpmcnt||(chk=!1,currInstalled=!1),currStatus.kpmsvc||(chk=!1,currInstalled=!1),currStatus.isInstalled=currInstalled}return SECUKITNX_CHECK.chkInfoStatus.status=chk,nxlog("_SERVICE.moduleCheck.chkInfoStatus",SECUKITNX_CHECK.chkInfoStatus),void eval(SECUKITNX_CHECK.chkCallback)(SECUKITNX_CHECK.chkInfoStatus)}var pluginInfo=SECUKITNX_CONST.pluginInfo[currPluginCnt],checkCallback="SECUKITNX_CHECK.serviceVersionCheck",request={};request.tabid=SECUKITNX_CONST.extabid,request.init="get_versions",request.m=pluginInfo.exModuleName,request.origin=location.origin,request.lic=pluginInfo.lic,request.callback="";try{var params={TOKEN:"Getversion"};this.GetversionInvoke("GetVersion",[params],checkCallback,checkCallback)}catch(e){return nxalert("_SERVICE.moduleCheck.portCheck",e),void SECUKITNX_CHECK.moduleCheck(SECUKITNX_CHECK.chkCurrPluginCnt+1)}},req:null,pageCallbackTmp:null,GetversionInvoke:function(fname,args,exCallback,pageCallback){SECUKITNX_CONST.cmdCnt.push(pageCallback),window.XDomainRequest?req=new XDomainRequest:window.ActiveXObject?req=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(req=new XMLHttpRequest);var request=new Object;request.callback=exCallback,callBackFuncName=exCallback?exCallback:null;var tmp_TOKEN=args[0].TOKEN;tmp_TOKEN&&null!==tmp_TOKEN||(tmp_TOKEN="empty"),tmp_serviceType=SECUKITNX_CONST.serviceType;var exfunc=new Object;exfunc.fname=fname,exfunc.args=args,request.exfunc=exfunc;var strRequest=JSON.stringify(request);if(window.XDomainRequest){req.onerror=this.resPonseERRXDR,req.onload=this.resPonseXDR,req.ontimeout=this.responseTimeOutXDR,req.onprogress=this.responseProgressXDR;var browserInfo=SECUKITNX_UTIL.getBrowserInfo(),urlTmp=document.URL;-1!==urlTmp.indexOf("https")?(req.open("GET",secukitnxInfo.exServiceInfo.localhost+":"+secukitnxInfo.exServiceInfo.PortNum+"?TOKEN="+tmp_TOKEN+"&serviceType="+tmp_serviceType),req.send(strRequest)):-1===urlTmp.indexOf("https")&&("MSIE"===browserInfo.browser&&"11"===browserInfo.version||"Edge"===browserInfo.browser)?(req.open("GET",secukitnxInfo.exServiceInfo.localhost+":"+secukitnxInfo.exServiceInfo.PortNum+"?TOKEN="+tmp_TOKEN+"&serviceType="+tmp_serviceType),req.send(strRequest)):(req.open("GET",secukitnxInfo.exServiceInfo.localhost2+":"+secukitnxInfo.exServiceInfo.PortNum2+"?TOKEN="+tmp_TOKEN+"&serviceType="+tmp_serviceType),setTimeout(function(){try{req.send(strRequest)}catch(a){nxlog(a)}},5))}else req.open("GET",secukitnxInfo.exServiceInfo.localhost+":"+secukitnxInfo.exServiceInfo.PortNum+"?TOKEN="+tmp_TOKEN+"&serviceType="+tmp_serviceType,!0),req.setRequestHeader("Accept","application/JSON"),req.setRequestHeader("Content-Type","text/plain"),req.onreadystatechange=function(aEvt){if(4===req.readyState)if(200===req.status){if(""!==req.responseText){var tmp_msg=JSON.parse(req.responseText);_requestMsg=tmp_msg,tmp_msg.callback=SECUKITNX_CONST.cmdCnt[0],SECUKITNX_CONST.cmdCnt.shift(),eval(callBackFuncName)(tmp_msg)}}else nxlog("Error loading page\n"),SECUKITNX_CHECK.moduleCheck(SECUKITNX_CHECK.chkCurrPluginCnt+1),SECUKITNX_CONST.cmdCnt.shift()},req.send(strRequest)},resPonseXDR:function(){var tmp_msg="";""!==req.responseText&&(tmp_msg=JSON.parse(req.responseText),_requestMsg=tmp_msg,tmp_msg.callback=SECUKITNX_CONST.cmdCnt[0],SECUKITNX_CONST.cmdCnt.shift(),eval(callBackFuncName)(tmp_msg))},resPonseERRXDR:function(){SECUKITNX_CONST.cmdCnt.shift(),SECUKITNX_CHECK.moduleCheck(SECUKITNX_CHECK.chkCurrPluginCnt+1)},responseTimeOutXDR:function(){SECUKITNX_CONST.cmdCnt.shift(),SECUKITNX_CHECK.moduleCheck(SECUKITNX_CHECK.chkCurrPluginCnt+1)},responseProgressXDR:function(){},serviceVersionCheck:function(a){var b=SECUKITNX_CONST.pluginInfo[SECUKITNX_CHECK.chkCurrPluginCnt];if(a){if("-1"===a)return void SECUKITNX_CHECK.moduleCheck(SECUKITNX_CHECK.chkCurrPluginCnt+1);if(a.reply.result&&a.reply.result.kpmsvc)try{var c="";c=b.moduleInfo.exNxClient_kpmsvc_exe,SECUKITNX_UTIL.diffVersion(a.reply.result.kpmsvc,c)===!1?SECUKITNX_CHECK.setServiceStatus("kpmsvc",a.reply.result.kpmsvc,!1,!0):SECUKITNX_CHECK.setServiceStatus("kpmsvc",a.reply.result.kpmsvc,!0,!0),c=b.moduleInfo.exNxClient_kpmcnt_exe,SECUKITNX_UTIL.diffVersion(a.reply.result.kpmcnt,c)===!1?SECUKITNX_CHECK.setServiceStatus("kpmcnt",a.reply.result.kpmcnt,!1,!0):SECUKITNX_CHECK.setServiceStatus("kpmcnt",a.reply.result.kpmcnt,!0,!0),1===SECUKITNX_CONST.serviceType&&(c=b.moduleInfo.exNxClient_secukitNX_dll,a.reply.result.secukitNX?SECUKITNX_UTIL.diffVersion(a.reply.result.secukitNX,c)===!1?SECUKITNX_CHECK.setServiceStatus("NX",a.reply.result.secukitNX,!1,!0):SECUKITNX_CHECK.setServiceStatus("NX",a.reply.result.secukitNX,!0,!0):SECUKITNX_CHECK.setServiceStatus("NX","",!1,!0)),2===SECUKITNX_CONST.serviceType&&(c=b.moduleInfo.exNxClient_secuXML_dll,a.reply.result.secuXML?SECUKITNX_UTIL.diffVersion(a.reply.result.secuXML,c)===!1?SECUKITNX_CHECK.setServiceStatus("xml",a.reply.result.secuXML,!1,!0):SECUKITNX_CHECK.setServiceStatus("xml",a.reply.result.secuXML,!0,!0):SECUKITNX_CHECK.setServiceStatus("xml","",!1,!0)),3===SECUKITNX_CONST.serviceType&&(c=b.moduleInfo.exNxClient_kms_dll,a.reply.result.kms?SECUKITNX_UTIL.diffVersion(a.reply.result.kms,c)===!1?SECUKITNX_CHECK.setServiceStatus("kms",a.reply.result.kms,!1,!0):SECUKITNX_CHECK.setServiceStatus("kms",a.reply.result.kms,!0,!0):SECUKITNX_CHECK.setServiceStatus("kms","",!1,!0)),SECUKITNX_CHECK.moduleCheck(SECUKITNX_CHECK.chkCurrPluginCnt+1)}catch(d){nxlog("_SERVICE.serviceVersionCheck","NxClient version check exception")}else SECUKITNX_CHECK.moduleCheck(SECUKITNX_CHECK.chkCurrPluginCnt+1)}else nxlog("_SERVICE.serviceVersionCheck",b.exPluginName+" updateInfo Error"),SECUKITNX_CHECK.moduleCheck(SECUKITNX_CHECK.chkCurrPluginCnt+1)},setServiceStatus:function(a,b,c){switch(a){case"kpmsvc":SECUKITNX_CHECK.chkInfoStatus.info[SECUKITNX_CHECK.chkCurrPluginCnt].kpmsvcVer=b,SECUKITNX_CHECK.chkInfoStatus.info[SECUKITNX_CHECK.chkCurrPluginCnt].kpmsvc=c;break;case"kpmcnt":SECUKITNX_CHECK.chkInfoStatus.info[SECUKITNX_CHECK.chkCurrPluginCnt].kpmcntVer=b,SECUKITNX_CHECK.chkInfoStatus.info[SECUKITNX_CHECK.chkCurrPluginCnt].kpmcnt=c;break;case"NX":SECUKITNX_CHECK.chkInfoStatus.info[SECUKITNX_CHECK.chkCurrPluginCnt].nxVer=b,SECUKITNX_CHECK.chkInfoStatus.info[SECUKITNX_CHECK.chkCurrPluginCnt].nx=c;break;case"kms":SECUKITNX_CHECK.chkInfoStatus.info[SECUKITNX_CHECK.chkCurrPluginCnt].kmsVer=b,SECUKITNX_CHECK.chkInfoStatus.info[SECUKITNX_CHECK.chkCurrPluginCnt].kms=c;break;case"xml":SECUKITNX_CHECK.chkInfoStatus.info[SECUKITNX_CHECK.chkCurrPluginCnt].xmlVer=b,SECUKITNX_CHECK.chkInfoStatus.info[SECUKITNX_CHECK.chkCurrPluginCnt].xml=c}}},SECUKITNX_EX=function(property){this.isInstalled=property.isInstalled,this.exPluginName=property.exPluginName,this.exModuleName=property.exModuleName?property.exModuleName:property.exProtocolName,this.exDefaultCallbackName=property.exDefaultCallback?property.exDefaultCallback:property.exPluginName+".exDefaultCallback",hostid=property.hostid?property.hostid:location.host,this.initEXInfoArr=[],this.exInterfaceArr=[],this.exEcho=!1,this.setEcho=function(a){this.exEcho=a};var req=null,pageCallbackTmp=null,callBackFuncName=null;this.Invoke=function(fname,args,exCallback,pageCallback){pageCallbackTmp=null,pageCallbackTmp=pageCallback,window.XDomainRequest?req=new XDomainRequest:window.ActiveXObject?req=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(req=new XMLHttpRequest);var request=new Object;switch(request.callback=exCallback,callBackFuncName=exCallback?exCallback:null,tmp_serviceType=SECUKITNX_CONST.serviceType,tmp_serviceType){case 1:SECUKITNX_CONST.serviceToken="empty";break;case 2:SECUKITNX_CONST.serviceToken="1234&OP=1";break;case 3:SECUKITNX_CONST.serviceToken="GetVersion"}tmp_TOKEN=SECUKITNX_CONST.serviceToken;var exfunc=new Object;exfunc.fname=fname,exfunc.args=args,request.exfunc=exfunc;var strRequest=JSON.stringify(request);if(window.XDomainRequest){req.onerror=this.resPonseERRXDR,req.onload=this.resPonseXDR,req.ontimeout=this.responseTimeOutXDR,req.onprogress=this.responseProgressXDR;var browserInfo=SECUKITNX_UTIL.getBrowserInfo(),urlTmp=document.URL;-1!==urlTmp.indexOf("https")?(req.open("POST",secukitnxInfo.exServiceInfo.localhost+":"+secukitnxInfo.exServiceInfo.PortNum+"?TOKEN="+tmp_TOKEN+"&serviceType="+tmp_serviceType),req.send(strRequest)):-1===urlTmp.indexOf("https")&&("MSIE"===browserInfo.browser&&"11"===browserInfo.version||"Edge"===browserInfo.browser)?(req.open("POST",secukitnxInfo.exServiceInfo.localhost+":"+secukitnxInfo.exServiceInfo.PortNum+"?TOKEN="+tmp_TOKEN+"&serviceType="+tmp_serviceType),req.send(strRequest)):(req.open("POST",secukitnxInfo.exServiceInfo.localhost2+":"+secukitnxInfo.exServiceInfo.PortNum2+"?TOKEN="+tmp_TOKEN+"&serviceType="+tmp_serviceType),setTimeout(function(){req.send(strRequest)},5))}else req.open("POST",secukitnxInfo.exServiceInfo.localhost+":"+secukitnxInfo.exServiceInfo.PortNum+"?TOKEN="+tmp_TOKEN+"&serviceType="+tmp_serviceType,!0),2===tmp_serviceType?(req.withCredentials=!0,req.setRequestHeader("Accept","application/JSON, OP:0x000001")):req.setRequestHeader("Accept","application/JSON"),req.setRequestHeader("Content-Type","text/plain"),req.onreadystatechange=function(aEvt){if(4===req.readyState)if(200===req.status){if(""!==req.responseText){var tmp_msg=JSON.parse(req.responseText);tmp_msg.callback=pageCallbackTmp,eval(callBackFuncName)(tmp_msg)}}else nxlog("Error loading page\n")},req.send(strRequest)},this.resPonseXDR=function(){var tmp_msg="";""!==req.responseText&&(tmp_msg=JSON.parse(req.responseText),tmp_msg.callback=pageCallbackTmp,eval(callBackFuncName)(tmp_msg))},this.resPonseERRXDR=function(){nxlog("Error loading NX Module\n")},this.responseTimeOutXDR=function(){nxlog("Error loading NX Module TimeOut\n")},this.responseProgressXDR=function(){},this.InitEX=function(a,b,c,d,e){var f=(this.createInitEXURL(a,this.exPluginName+".InitEXCallback"),{});f.id=a,f.tabid=SECUKITNX_CONST.extabid,f.module=this.exModuleName,f.cmd=b,f.origin=void 0!==location.origin?location.origin:location.protocol+"//"+hostid,f.exfunc={},f.exfunc.fname=c,f.callback=e,this.exEcho&&(f.echo=!0);var g=f.exfunc;if(d)if(d instanceof Array)g.args=d;else{var h=[d];g.args=h}else g.args=[];var i={id:a,json:f,callback:e};this.initEXInfoArr.push(i)},this.InitEXCallback=function(a){var b,c;if(!this.initEXInfoArr)return nxlog(this.exPluginName+".InitEXCallback [exception]",NX_EXPROTO_TEXT_15),void nxalert(this.exPluginName+".InitEXCallback [exception]",NX_EXPROTO_TEXT_15);for(var d=0;d<this.initEXInfoArr.length;d++)if(initExObj=this.initEXInfoArr[d],initExObj.id===a){c=initExObj.json,b=initExObj.json.callback,this.initEXInfoArr.splice(d,1);break}this.InvokeEX(a,b,c)},this.InvokeEX=function(a,b,c){var d=document.getElementById(SECUKITNX_CONST.exFormName);if(d.target=SECUKITNX_CONST.exIframeName,d.action=this.createEXURL(a,this.exPluginName+".InvokeCallback"),d.elements.length>1)for(var e=0;e<d.elements.length;){var f=d.elements[e],g=f.id?f.id:"",h=f.name?f.name:"";g!==SECUKITNX_CONST.exFormDataName||h!==SECUKITNX_CONST.exFormDataName?(nxlog(this.exPluginName+".InvokeEX.form remove garbage param",g+"::"+h),f.parentElement.removeChild(f)):e++}var i=d.elements[0];i.value=JSON.stringify(c),nxlog(this.exPluginName+".InvokeEX.form.action",d.action),nxlog(this.exPluginName+".InvokeEX."+this.exFormDataName+".value",i.value),d.submit()},this.InvokeCallback=function(response){if(response)try{if(nxlog(this.exPluginName+".InvokeCallback.response",response),"object"==typeof response)var strSerial=JSON.stringify(response);else"string"==typeof response&&(response=JSON.parse(response));var status=response.status;if("TRUE"===status){for(var id=response.id,funcInfo={},i=0;i<this.exInterfaceArr.length;i++)if(this.exInterfaceArr[i]){var arrObj=this.exInterfaceArr[i];if(arrObj.id===id){funcInfo=arrObj,this.exInterfaceArr.splice(i,1);break}}var callback=funcInfo.EXCallback,reply=response.reply.reply;if(callback){if(reply instanceof Array){var strReply={};strReply.callback=funcInfo.pageCallback;var replyArr;replyArr="[";for(var i in reply){var str=reply[i];str=str.replace("\\r","\r"),str=str.replace("\\n","\n"),replyArr+="'"+str+"',"}replyArr+="]",strReply.reply=replyArr,callback=callback+"("+JSON.stringify(strReply)+");"}else if("string"==typeof reply){var strReply={};strReply.callback=funcInfo.pageCallback,strReply.reply=reply.replace("\\r","\r").replace("\\n","\n"),callback=callback+"("+JSON.stringify(strReply)+");"}else"object"==typeof reply?(reply.callback=funcInfo.pageCallback,callback=callback+"("+JSON.stringify(reply)+");"):callback+="()";setTimeout(function(){eval(callback)},5)}}else nxlog(this.exPluginName+".InvokeCallback","native response status not TRUE"),eval(this.exDefaultCallbackName)(response)}catch(e){nxlog(this.exPluginName+".InvokeCallback [exception]",e),nxlog(this.exPluginName+".InvokeCallback [exception]","native response process exception"),eval(this.exDefaultCallbackName)(response)}else nxlog(this.exPluginName+".InvokeCallback","native call not response"),eval(this.exDefaultCallbackName)()}},SECUKITNX_UTIL={nxlog:function(a,b){if(SECUKITNX_CONST.debug){var c;try{if("undefined"==typeof b)c="[undefined]";else if("function"==typeof b)c="[function] "+b;else if("object"==typeof b)try{c="[json] "+JSON.stringify(b)}catch(d){c="[object] "+b}else c="number"==typeof b?"[number] "+b:"string"==typeof b?"[string] "+b:"boolean"==typeof b?"[boolean] "+b:"[other] "+b.toString()}catch(d){c=" [nxlog exception] "+typeof b}return window.console||(console=window.console||{log:function(){}}),void console.log("[nxlog] "+SECUKITNX_CONST.frameName+a+" : "+c)}},nxalert:function(a,b){if(SECUKITNX_CONST.debugAlert){var c;try{b&&(c="object"==typeof b?JSON.stringify(b):"function"==typeof b?b:"number"==typeof b?b:"string"==typeof b?b:"boolean"==typeof b?b:b.toString())}catch(d){c="[exception] "+b}return void alert(a?a+" : "+c:c)}},findPath:function(currentFrame,tmpPath){if(currentFrame===top)return"";var path,pathObj;tmpPath?(pathObj=eval(tmpPath),path=tmpPath):(pathObj=top,path="top");for(var frameCnt=pathObj.frames.length,i=0;frameCnt>i;i++){var fr=pathObj.frames[i];if(currentFrame===fr)return path+".frames["+i+"].";if(fr.frames.length>0){var resultPath=SECUKITNX_UTIL.findPath(currentFrame,path+".frames["+i+"]");if(resultPath)return resultPath}}},getOSInfo:function(){var a=navigator.platform,b=navigator.userAgent,c={};return"Win32"===a||"Win64"===a?b.search("Windows Phone")>=0?(c.platform="Windows Phone",c.name="Windows Phone"):c.platform="WINDOWS":c.platform="UNKNOWN","WINDOWS"==c.platform?(-1!==b.indexOf("Windows NT 5.1")?(c.version="5.1",c.name="XP"):-1!==b.indexOf("Windows NT 6.0")?(c.version="6.0",c.name="VISTA"):-1!==b.indexOf("Windows NT 6.1")?(c.version="6.1",c.name="7"):-1!==b.indexOf("Windows NT 6.2")?(c.version="6.2",c.name="8"):-1!==b.indexOf("Windows NT 6.3")?(c.version="6.3",c.name="8.1"):-1!==b.indexOf("Windows NT 6.4")?(c.version="6.4",c.name="10"):-1!==b.indexOf("Windows NT 10.0")?(c.version="10.0",c.name="10"):-1!==b.indexOf("Windows NT")?(c.version="UNKNOWN",c.name="UNKNOWN"):(c.version="UNKNOWN",c.name="UNKNOWN"),c.bit=-1!==b.indexOf("WOW64")||-1!==b.indexOf("Win64")?"64":"32"):(c.version="UNKNOWN",c.name="UNKNOWN"),c},isWin:function(){var a=SECUKITNX_CONST.OSInfo.platform;return a||(a=SECUKITNX_UTIL.getOSInfo().platform),"WINDOWS"===a?!0:!1},getBrowserInfo:function(){var a,b,c,d=navigator.platform,e=navigator.appName,f=navigator.userAgent;if(c=f.match(/(edge)\/?\s*(\.?\d+(\.\d+)*)/i),c=c?{browser:"Edge",version:c[2]}:c,c||(c=f.match(/(opera|opr)\/?\s*(\.?\d+(\.\d+)*)/i),c&&null!==(a=f.match(/version\/([\.\d]+)/i))&&(c[2]=a[1]),c=c?{browser:"Opera",version:c[2]}:c),c||(c=f.match(/MSIE ([6789].\d+)/),c&&(c={browser:"MSIE",version:c[1]})),c||(c=f.match(/(msie|trident|chrome|safari|firefox)\/?\s*(\.?\d+(\.\d+)*)/i),c&&(null!==(a=f.match(/rv:([\d]+)/))?c[2]=a[1]:null!==(a=f.match(/version\/([\.\d]+)/i))&&(c[2]=a[1]),"Trident"===c[1]&&(c[1]="MSIE"),c=c?{browser:c[1],version:c[2]}:{browser:e,version1:navigator.appVersion,other:"-?"})),c||(c={browser:"Edge",version:""}),!c)return{browser:"UNDEFINED",version:""};if(c.version){var g=c.version.split(".");c.version=g[0]}return("MSIE"===c.browser||"Edge"===c.browser)&&("Win32"===d?c.bit="32":"Win64"===d&&(c.bit="64")),b=c},getBrowserVer:function(){var a=SECUKITNX_CONST.browserInfo;return a||(a=SECUKITNX_UTIL.getBrowserInfo()),a.version},getBrowserBit:function(){var a=SECUKITNX_CONST.browserInfo;return a||(a=SECUKITNX_UTIL.getBrowserInfo()),a.bit},isIE:function(){var a=SECUKITNX_CONST.browserInfo;return a||(a=SECUKITNX_UTIL.getBrowserInfo()),-1!==a.browser.toLowerCase().indexOf("msie")?!0:!1},isEdge:function(){var a=SECUKITNX_CONST.browserInfo;return a||(a=SECUKITNX_UTIL.getBrowserInfo()),-1!==a.browser.toLowerCase().indexOf("edge")?!0:!1},isChrome:function(){var a=SECUKITNX_CONST.browserInfo;return a||(a=SECUKITNX_UTIL.getBrowserInfo()),-1!==a.browser.toLowerCase().indexOf("chrome")?!0:!1},isFirefox:function(){var a=SECUKITNX_CONST.browserInfo;return a||(a=SECUKITNX_UTIL.getBrowserInfo()),-1!==a.browser.toLowerCase().indexOf("firefox")?!0:!1},isOpera:function(){var a=SECUKITNX_CONST.browserInfo;return a||(a=SECUKITNX_UTIL.getBrowserInfo()),-1!==a.browser.toLowerCase().indexOf("opera")?!0:!1},isSafari:function(){var a=SECUKITNX_CONST.browserInfo;return a||(a=SECUKITNX_UTIL.getBrowserInfo()),-1!==a.browser.toLowerCase().indexOf("safari")?!0:!1},createId:function(){var a=(new Date).getTime()+"_"+Math.floor(1e4*Math.random())+1;return a},diffVersion:function(a,b){var c;try{c=a.indexOf("version:",0)}catch(d){return!1}if(c>=0){a=a.substring(c+8,a.length);var e=a.split(".");if(e.length<4&&(e=a.split(",")),e.length<4)return!1;for(var f=b.split("."),g=0;4>g;g++){if(parseInt(e[g],10)>parseInt(f[g],10))return!0;if(parseInt(e[g],10)<parseInt(f[g],10))return SECUKITNX_CONST.nextVerCheck=!0,!1}return!0}var e=a.split(".");if(e.length<4&&(e=a.split(",")),e.length<4)return!1;for(var f=b.split("."),g=0;4>g;g++){if(parseInt(e[g],10)>parseInt(f[g],10))return!0;if(parseInt(e[g],10)<parseInt(f[g],10))return SECUKITNX_CONST.nextVerCheck=!0,!1}return!0}};window.nxlog=SECUKITNX_UTIL.nxlog,window.nxalert=SECUKITNX_UTIL.nxalert;